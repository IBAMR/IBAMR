// Scalar parameters

LENGTH = 150e-6
WIDTH  = 40e-6
LAMBDA0 = 1.876e-3
MU0 = 0.893e-3
RHO0 = 998
RHO1 = 0.0
OMEGA0 = 3.1416e7   // acoustic_angular_frequency
C0 = 1500         // speed of sound
D0 = 1e-9

Nx = 300
Ny = 80
h = LENGTH/Nx
PERIODIC_BC = 0

XCOM = LENGTH/4.0
YCOM = WIDTH/2.0
Radius = 5.0e-6
Contour_XCOM = LENGTH/4.0
Contour_YCOM = WIDTH/2.0
Contour_Radius = 10.0e-6

FOVelocityInitialConditions {

   function_0 = "0.0"     // ur x-component
   function_1 = "0.0"     // vr y-component

   function_2 = "0.0"     // ui x-component
   function_3 = "0.0"     // vi y-component

}


SOVelocityInitialConditions {

   function_0 = "0.0"     // u x-component
   function_1 = "0.0"     // v y-component
}


FOPressureInitialConditions {

   function_0 = "0.0"     // pr
   function_1 = "0.0"     // pi

}


SOPressureInitialConditions {
   function = "0.0"
}


mu {

   mu0 = MU0
   function = "mu0"
}

lambda {

   lambda0 = LAMBDA0
   function = "lambda0"
}

rho {

   rho0 = RHO0
   rho1 = RHO1
   Fcn = "rho0+rho1*X1"
   function = Fcn
}


// u1r velocity
FOVelocityRealBcCoefs_0 {

   acoef_function_0 = "1.0"
   acoef_function_1 = "1.0"
   acoef_function_2 = "1.0"
   acoef_function_3 = "1.0"

   bcoef_function_0 = "0.0"
   bcoef_function_1 = "0.0"
   bcoef_function_2 = "0.0"
   bcoef_function_3 = "0.0"

   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"

}

// v1r velocity
FOVelocityRealBcCoefs_1 {

   acoef_function_0 = "1.0"
   acoef_function_1 = "1.0"
   acoef_function_2 = "1.0"
   acoef_function_3 = "1.0"

   bcoef_function_0 = "0.0"
   bcoef_function_1 = "0.0"
   bcoef_function_2 = "0.0"
   bcoef_function_3 = "0.0"

   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"

}

// u1i velocity
FOVelocityImagBcCoefs_0 {

   omega = OMEGA0
   d     = D0

   acoef_function_0 = "1.0"
   acoef_function_1 = "1.0"
   acoef_function_2 = "1.0"
   acoef_function_3 = "1.0"

   bcoef_function_0 = "0.0"
   bcoef_function_1 = "0.0"
   bcoef_function_2 = "0.0"
   bcoef_function_3 = "0.0"

   gcoef_function_0 = "omega*d"
   gcoef_function_1 = "omega*d"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"

}

// v1i velocity
FOVelocityImagBcCoefs_1 {

   acoef_function_0 = "1.0"
   acoef_function_1 = "1.0"
   acoef_function_2 = "1.0"
   acoef_function_3 = "1.0"

   bcoef_function_0 = "0.0"
   bcoef_function_1 = "0.0"
   bcoef_function_2 = "0.0"
   bcoef_function_3 = "0.0"

   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"

}

DensityBcCoefs_0 {
   acoef_function_0 = "0.0"
   acoef_function_1 = "0.0"
   acoef_function_2 = "0.0"
   acoef_function_3 = "0.0"

   bcoef_function_0 = "1.0"
   bcoef_function_1 = "1.0"
   bcoef_function_2 = "1.0"
   bcoef_function_3 = "1.0"

   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"

}

DensityBcCoefs_1 {

   acoef_function_0 = "0.0"
   acoef_function_1 = "0.0"
   acoef_function_2 = "0.0"
   acoef_function_3 = "0.0"

   bcoef_function_0 = "1.0"
   bcoef_function_1 = "1.0"
   bcoef_function_2 = "1.0"
   bcoef_function_3 = "1.0"

   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"

}

ShearViscosityBcCoefs {

   acoef_function_0 = "0.0"
   acoef_function_1 = "0.0"
   acoef_function_2 = "0.0"
   acoef_function_3 = "0.0"

   bcoef_function_0 = "1.0"
   bcoef_function_1 = "1.0"
   bcoef_function_2 = "1.0"
   bcoef_function_3 = "1.0"

   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"

}

BulkViscosityBcCoefs {

   acoef_function_0 = "0.0"
   acoef_function_1 = "0.0"
   acoef_function_2 = "0.0"
   acoef_function_3 = "0.0"

   bcoef_function_0 = "1.0"
   bcoef_function_1 = "1.0"
   bcoef_function_2 = "1.0"
   bcoef_function_3 = "1.0"

   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"

}

START_TIME                          =  0.0e0     // initial simulation time
END_TIME                            =  1.5e0     // final simulation time
GROW_DT                             =  2.0e0     // growth factor for timesteps
MAX_INTEGRATOR_STEPS                =  1         // max number of simulation timesteps
REGRID_INTERVAL                     =  5
CFL_MAX                             =  1.0
NUM_INS_CYCLES                      =  1
PRECOND_REINIT_INTERVAL             =  1
ENABLE_LOGGING                      = TRUE
NORMALIZE_PRESSURE                  = TRUE
NORMALIZE_VELOCITY                  = FALSE
EXPLICITLY_REMOVE_NULLSPACE         = TRUE
HAS_RIGID_BODY_NULLSPACE            = TRUE
VORTICITY_TAGGING                   = TRUE       // whether to tag cells for refinement based on vorticity thresholds
TAG_BUFFER                          = 2          // size of tag buffer used by grid generation algorithm
DT_MAX                              = 10
OUTPUT_U1                           = TRUE
OUTPUT_U2                           = TRUE
OUTPUT_P1                           = TRUE
OUTPUT_P2                           = TRUE
OUTPUT_OMEGA2                       = TRUE
OUTPUT_RHO                          = TRUE
OUTPUT_MU                           = TRUE
COUPLE_FIRST_SECOND_ORDER_SYSTEM    = TRUE

AcousticStreamingHierarchyIntegrator {

   start_time                  = START_TIME
   end_time                    = END_TIME
   grow_dt                     = GROW_DT
   normalize_pressure          = NORMALIZE_PRESSURE
   normalize_velocity          = NORMALIZE_VELOCITY
   cfl                         = CFL_MAX
   dt_max                      = DT_MAX
   using_vorticity_tagging     = VORTICITY_TAGGING
   vorticity_rel_thresh        = 0.25
   tag_buffer                  = TAG_BUFFER
   regrid_interval             = REGRID_INTERVAL
   output_U1                   = OUTPUT_U1
   output_U2                   = OUTPUT_U2
   output_P1                   = OUTPUT_P1
   output_P2                   = OUTPUT_P2
   output_Omega2               = OUTPUT_OMEGA2
   output_rho                  = OUTPUT_RHO
   output_mu                   = OUTPUT_MU
   precond_reinit_interval     = PRECOND_REINIT_INTERVAL
   enable_logging              = ENABLE_LOGGING
   max_integrator_steps        = MAX_INTEGRATOR_STEPS
   explicitly_remove_nullspace = EXPLICITLY_REMOVE_NULLSPACE
   has_rigid_body_nullspace    = HAS_RIGID_BODY_NULLSPACE
   num_cycles                  = NUM_INS_CYCLES

   acoustic_angular_frequency = OMEGA0
   sound_speed    = C0
   coupled_system = COUPLE_FIRST_SECOND_ORDER_SYSTEM
   stokes_drift_bc = TRUE
   stokes_drift_mass_src = TRUE
   rho_vc_interpolation_type = "VC_AVERAGE_INTERP"
   mu_vc_interpolation_type  = "VC_AVERAGE_INTERP"
   write_contour_integrals = TRUE

   first_order_solver_db {
      ksp_type          = "fgmres"
      pc_type           = "lu"
      rel_residual_tol  = 1.0e-12
      abs_residual_tol  = 1.0e-15
      initial_guess_nonzero = FALSE
   }

   stokes_solver_db {
      ksp_type       = "fgmres"
      max_iterations = 2500
      rel_residual_tol = 1e-9
   }

   stokes_precond_db {
      max_iterations = 1
   }

   velocity_solver_db {
      ksp_type = "richardson"
      max_iterations = 1
      rel_residual_tol = 1.0e-1
   }

   velocity_precond_db {
      max_iterations = 10
      ksp_type = "gmres"
      pc_type = "lu"
   }

   pressure_solver_db {
      ksp_type = "richardson"
      max_iterations = 1
      rel_residual_tol = 1.0e-1
   }

   pressure_precond_db {
      solver_type     = "PFMG"
      enable_logging  = FALSE
      num_pre_sweeps  = 0
      num_post_sweeps = 2
      rel_residual_tol = 1.0e-8
      abs_residual_tol = 1.0e-9
      max_iterations = 100
   }

}

FOBrinkmanPenalization {

   penalty_factor = 1e10*RHO0*OMEGA0
   num_interface_cells = 1

}

SOBrinkmanPenalization {

   penalty_factor = 1e10*(MU0/h^2)
   num_interface_cells = 1

}

Main {

   // log file parameters
   log_file_name = "acoustic_hier_2d.log"
   log_all_nodes = FALSE

   // visualization dump parameters
   viz_writer = "VisIt"
   viz_dump_interval = 1               //zero to turn off
   viz_dump_dirname = "viz2d_acoustic_hier"
   visit_number_procs_per_file = 1

   // restart dump parameters
   restart_interval      = 0                 // zero to turn off
   restart_write_dirname = "restart_acoustic_2d"

   // timer dump parameters
   timer_dump_interval  = 0                 // zero to turn off
   timer_enabled = FALSE

}


CartesianGeometry {
   domain_boxes       = [(0,0), (Nx - 1,Ny - 1)]
   x_lo               = 0, 0      // lower end of computational domain.
   x_up               = LENGTH, WIDTH       // upper end of computational domain.
   periodic_dimension = PERIODIC_BC, PERIODIC_BC
}

GriddingAlgorithm {
   max_levels = 1                 // Maximum number of levels in hierarchy.

   ratio_to_coarser {
      level_1 = 4, 4              // vector ratio to next coarser level
   }

   largest_patch_size {
      level_0 = 512, 512          // largest patch allowed in hierarchy
                                  // all finer levels will use same values as level_0...
   }

   smallest_patch_size {
      level_0 =   4,   4          // smallest patch allowed in hierarchy
                                  // all finer levels will use same values as level_0...
   }

   efficiency_tolerance = 0.70e0  // min % of tag cells in new patch level
   combine_efficiency   = 0.85e0  // chop box if sum of volumes of smaller
                                  // boxes < efficiency * vol of large box
}

StandardTagAndInitialize {
   tagging_method = "REFINE_BOXES"
   RefineBoxes {
//    level_0 = [( N/4 , 0 ),( 3*N/4 - 1 , N - 1 )]
//    level_0 = [( 0 , N/4 ),( N - 1 , 3*N/4 - 1 )]
//    level_0 = [( N/4 , N/4 ),( 3*N/4 - 1 , 3*N/4 - 1 )]
//    level_0 = [( N/4 , N/4 ),( 3*N/4 - 1 , N/2 - 1 )] , [( N/4 , N/2 ),( N/2 - 1 , 3*N/4 - 1 )]
//    level_0 = [( N/4 , N/4 ),( N/2 - 1 , 3*N/4 - 1 )] , [( N/2 , N/4 ),( 3*N/4 - 1 , N/2 - 1 )]
   }
}

LoadBalancer {
   bin_pack_method = "SPATIAL"
   max_workload_factor = 1
}

TimerManager{
   print_exclusive = FALSE
   print_total = TRUE
   print_threshold = 1.0
   timer_list = "IBTK::*::*"
}
