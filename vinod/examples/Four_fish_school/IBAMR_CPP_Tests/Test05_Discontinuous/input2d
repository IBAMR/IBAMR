// =============================================================================
// Test 05: Discontinuous Initial Condition - Input Configuration
// =============================================================================
// Tests stability with top-hat (step) function
// Validates: Monotonicity, no oscillations, robustness
// =============================================================================

// Physical parameters
diffusion_coefficient = 0.01

// Top-hat initial condition parameters
tophat_x0 = 0.0                     // Center X
tophat_y0 = 0.0                     // Center Y
tophat_radius = 0.3                 // Cylinder radius
tophat_amplitude = 1.0              // Concentration inside

CartesianGeometry {
   domain_boxes = [ (0,0) , (63,63) ]
   x_lo = -1.0, -1.0
   x_up = 1.0, 1.0
   periodic_dimension = 0, 0
}

Main {
   log_file_name = "test05.log"
   log_all_nodes = FALSE
   viz_writer = "VisIt"
   viz_dump_interval = 5
   viz_dump_dirname = "viz_test05"
   timer_enabled = TRUE

   DT = 0.005
   START_TIME = 0.0
   END_TIME = 0.5
}

INSStaggeredHierarchyIntegrator {
   mu = 0.01
   rho = 1.0
   start_time = 0.0
   end_time = 0.5
   num_cycles = 1

   // Stationary fluid
   U = "0.0"
   V = "0.0"
}

AdvDiffHierarchyIntegrator {
   start_time = 0.0
   end_time = 0.5
   num_cycles = 1

   // Use Crank-Nicolson for stability
   diffusion_time_stepping_type = "CRANK_NICOLSON"

   // Conservative advection
   convective_time_stepping_type = "ADAMS_BASHFORTH"
   convective_op_type = "PPM"
   convective_difference_form = "CONSERVATIVE"
}

GriddingAlgorithm {
   max_levels = 1

   ratio_to_coarser {
      level_1 = 4, 4
   }

   largest_patch_size {
      level_0 = 512, 512
   }

   smallest_patch_size {
      level_0 = 8, 8
   }
}

StandardTagAndInitialize {
   tagging_method = "REFINE_BOXES"
   RefineBoxes {
   }
}

LoadBalancer {
   bin_pack_method = "SPATIAL"
   max_workload_factor = 1.0
}

// Top-hat (step) function: 1.0 inside circle, 0.0 outside
OdorInitialConditions {
   function = "(sqrt(X_0*X_0 + X_1*X_1) <= 0.3) ? 1.0 : 0.0"
}

// Dirichlet boundary conditions (homogeneous)
OdorBcCoefs {
   acoef_function_0 = "1.0"
   acoef_function_1 = "1.0"
   acoef_function_2 = "1.0"
   acoef_function_3 = "1.0"

   bcoef_function_0 = "0.0"
   bcoef_function_1 = "0.0"
   bcoef_function_2 = "0.0"
   bcoef_function_3 = "0.0"

   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"
}
